# -*- coding: utf-8 -*-
"""–ó–∞–¥–∞—á–∏ —Å —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–π –ø–æ Pandas

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1HJQzsxafKmUUjCOQGjB3KQXDTYhcQyY5

# –ó–∞–¥–∞—á–∏ —Å —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–π –ø–æ Pandas

## 1. **–ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º –∏ —Ä–∞—Å—á—ë—Ç –∞–≥—Ä–µ–≥–∞—Ç–æ–≤**  
**–ó–∞–¥–∞—á–∞:**  
–î–∞–Ω –¥–∞—Ç–∞—Ñ—Ä–µ–π–º —Å –¥–∞–Ω–Ω—ã–º–∏ –æ –ø—Ä–æ–¥–∞–∂–∞—Ö –ø—Ä–æ–¥—É–∫—Ç–æ–≤. –ù–µ–æ–±—Ö–æ–¥–∏–º–æ –Ω–∞–π—Ç–∏ –æ–±—â–∏–π –æ–±—ä—ë–º –ø—Ä–æ–¥–∞–∂ –ø–æ –∫–∞–∂–¥–æ–º—É –ø—Ä–æ–¥—É–∫—Ç—É –∏ —Å—Ä–µ–¥–Ω—é—é —Ü–µ–Ω—É –∑–∞ –µ–¥–∏–Ω–∏—Ü—É.  

**–ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞:**
"""

import pandas as pd

data = {
    'Product': ['A', 'B', 'C', 'A', 'B', 'C'],
    'Sales': [100, 150, 200, 300, 400, 500],
    'Price': [10, 15, 20, 10, 15, 20]
}

df = pd.DataFrame(data)
grouped = df.groupby('Product').agg({
    'Sales': 'sum',
    'Price': 'mean'
})

print(grouped)

"""### –û–±—ä—è—Å–Ω–µ–Ω–∏–µ:

### **1. –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –∏ –∞–≥—Ä–µ–≥–∞—Ü–∏—è**
**–≠—Ç–∞–ø—ã —Ä–∞–±–æ—Ç—ã —Å –¥–∞–Ω–Ω—ã–º–∏:**  
1. **`groupby('Product')`**  
   - –†–∞–∑–¥–µ–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –Ω–∞ –≥—Ä—É–ø–ø—ã –ø–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏—è–º –≤ —Å—Ç–æ–ª–±—Ü–µ `Product` (A, B, C).  
   - –°–æ–∑–¥–∞—ë—Ç –æ–±—ä–µ–∫—Ç `DataFrameGroupBy`, –∫–æ—Ç–æ—Ä—ã–π —Ö—Ä–∞–Ω–∏—Ç —Å—Å—ã–ª–∫–∏ –Ω–∞ –≥—Ä—É–ø–ø—ã, –Ω–æ –Ω–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –≤—ã—á–∏—Å–ª–µ–Ω–∏–π.  

2. **`agg({...})`**  
   - –ü—Ä–∏–º–µ–Ω—è–µ—Ç –∞–≥—Ä–µ–≥–∏—Ä—É—é—â–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∫ –∫–∞–∂–¥–æ–π –≥—Ä—É–ø–ø–µ.  
   - –î–ª—è `Sales` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `sum` (—Å—É–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ).  
   - –î–ª—è `Price` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `mean` (—Å—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ).  

**–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:**  
```
| –ì—Ä—É–ø–ø–∞ | Sales (sum) | Price (mean) |
|--------|-------------|--------------|
| **A**  | 100 + 300   | (10 + 10)/2  |
| **B**  | 150 + 400   | (15 + 15)/2  |
| **C**  | 200 + 500   | (20 + 20)/2  |
```

---

### **–ö–ª—é—á–µ–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã**
1. **–ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ vs –ê–≥—Ä–µ–≥–∞—Ü–∏—è**  
   - `groupby()` ‚Äî —Ç–æ–ª—å–∫–æ –≥—Ä—É–ø–ø–∏—Ä—É–µ—Ç, –Ω–æ –Ω–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Ä–∞—Å—á—ë—Ç—ã.  
   - `agg()` ‚Äî –ø—Ä–∏–º–µ–Ω—è–µ—Ç —Ñ—É–Ω–∫—Ü–∏–∏ –∫ –∫–∞–∂–¥–æ–π –≥—Ä—É–ø–ø–µ.  

2. **–°–ª–æ–≤–∞—Ä—å –∞–≥—Ä–µ–≥–∞—Ü–∏–π**  
   - –ö–ª—é—á–∏ —Å–ª–æ–≤–∞—Ä—è ‚Äî –Ω–∞–∑–≤–∞–Ω–∏—è —Å—Ç–æ–ª–±—Ü–æ–≤.  
   - –ó–Ω–∞—á–µ–Ω–∏—è ‚Äî —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –∞–≥—Ä–µ–≥–∞—Ü–∏–∏.  
   - –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–∞–∑–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Å—Ç–æ–ª–±—Ü–æ–≤.  

3. **–ò–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ**  
   - –†–µ–∑—É–ª—å—Ç–∞—Ç –∏–º–µ–µ—Ç –∏–Ω–¥–µ–∫—Å `Product`, —Ç–∞–∫ –∫–∞–∫ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –≤—ã–ø–æ–ª–Ω—è–ª–∞—Å—å –ø–æ —ç—Ç–æ–º—É —Å—Ç–æ–ª–±—Ü—É.  

---

### **–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ —Å–ø–æ—Å–æ–±—ã**
**–í–∞—Ä–∏–∞–Ω—Ç 1: –†–∞–∑–¥–µ–ª—å–Ω–∞—è –∞–≥—Ä–µ–≥–∞—Ü–∏—è**  
```python
sales_sum = df.groupby('Product')['Sales'].sum()
price_mean = df.groupby('Product')['Price'].mean()
result = pd.concat([sales_sum, price_mean], axis=1)
```

**–í–∞—Ä–∏–∞–Ω—Ç 2: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `pivot_table`**  
```python
pd.pivot_table(df,
              index='Product',
              values=['Sales', 'Price'],
              aggfunc={'Sales': 'sum', 'Price': 'mean'})
```

---

## 2. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π**  
**–ó–∞–¥–∞—á–∞:**  
–í –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–µ –µ—Å—Ç—å –ø—Ä–æ–ø—É—Å–∫–∏ –≤ —Å—Ç–æ–ª–±—Ü–µ `Age`. –ó–∞–º–µ–Ω–∏—Ç—å –∏—Ö –º–µ–¥–∏–∞–Ω–æ–π –¥–ª—è –º—É–∂—á–∏–Ω –∏ –∂–µ–Ω—â–∏–Ω –æ—Ç–¥–µ–ª—å–Ω–æ.  

**–ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞:**  
"""

import pandas as pd
import numpy as np

# –°–æ–∑–¥–∞–Ω–∏–µ –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–∞
df = pd.DataFrame({
    'Gender': ['M', 'F', 'M', 'F', 'M', 'F'],
    'Age': [25, np.nan, 30, 28, np.nan, 35]
})

# –†–∞—Å—á—ë—Ç –º–µ–¥–∏–∞–Ω—ã –ø–æ –≥—Ä—É–ø–ø–∞–º
median_ages = df.groupby('Gender')['Age'].median()

# –ó–∞–º–µ–Ω–∞ –ø—Ä–æ–ø—É—Å–∫–æ–≤
df['Age'] = df.groupby('Gender')['Age'].transform(lambda x: x.fillna(x.median()))

print(df)

"""### –û–±—ä—è—Å–Ω–µ–Ω–∏–µ —Ä–µ—à–µ–Ω–∏—è –∑–∞–¥–∞—á–∏:

### **1. –†–∞—Å—á—ë—Ç –º–µ–¥–∏–∞–Ω—ã –ø–æ –≥—Ä—É–ø–ø–∞–º**
```python
median_ages = df.groupby('Gender')['Age'].median()
```
**–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:**  
1. **`groupby('Gender')`**  
   - –†–∞–∑–¥–µ–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –Ω–∞ –¥–≤–µ –≥—Ä—É–ø–ø—ã: `M` (–º—É–∂—á–∏–Ω—ã) –∏ `F` (–∂–µ–Ω—â–∏–Ω—ã).  
   - –ü—Ä–∏–º–µ—Ä –≥—Ä—É–ø–ø:  
     - **–ú—É–∂—á–∏–Ω—ã**: `[25, 30, NaN]`  
     - **–ñ–µ–Ω—â–∏–Ω—ã**: `[NaN, 28, 35]`  

2. **`['Age'].median()`**  
   - –î–ª—è –∫–∞–∂–¥–æ–π –≥—Ä—É–ø–ø—ã —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç –º–µ–¥–∏–∞–Ω—É —Å—Ç–æ–ª–±—Ü–∞ `Age`, –∏–≥–Ω–æ—Ä–∏—Ä—É—è –ø—Ä–æ–ø—É—Å–∫–∏.  
   - **–ú—É–∂—á–∏–Ω—ã**: –º–µ–¥–∏–∞–Ω–∞ –∏–∑ `[25, 30, NaN]` ‚Üí **27.5**  
   - **–ñ–µ–Ω—â–∏–Ω—ã**: –º–µ–¥–∏–∞–Ω–∞ –∏–∑ `[NaN, 28, 35]` ‚Üí **31.5**  

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**  
```
Gender
F    31.5
M    27.5
Name: Age, dtype: float64
```

---

### **2. –ó–∞–º–µ–Ω–∞ –ø—Ä–æ–ø—É—Å–∫–æ–≤**
```python
df['Age'] = df.groupby('Gender')['Age'].transform(
    lambda x: x.fillna(x.median())
)
```
**–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:**  
1. **`groupby('Gender')['Age']`**  
   - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ–±—ä–µ–∫—Ç `DataFrameGroupBy` –¥–ª—è —Å—Ç–æ–ª–±—Ü–∞ `Age`, —Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–æ `Gender`.  

2. **`transform(lambda x: x.fillna(x.median()))`**  
   - –ü—Ä–∏–º–µ–Ω—è–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é –∫ –∫–∞–∂–¥–æ–π –≥—Ä—É–ø–ø–µ.  
   - **–§—É–Ω–∫—Ü–∏—è**:  
     - `x.fillna(x.median())` ‚Üí –∑–∞–º–µ–Ω—è–µ—Ç –ø—Ä–æ–ø—É—Å–∫–∏ –≤ –≥—Ä—É–ø–ø–µ –Ω–∞ –µ—ë –º–µ–¥–∏–∞–Ω—É.  
   - **Transform**:  
     - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å —Ç–µ–º –∂–µ –∏–Ω–¥–µ–∫—Å–æ–º, —á—Ç–æ –∏ –∏—Å—Ö–æ–¥–Ω—ã–π –¥–∞—Ç–∞—Ñ—Ä–µ–π–º.  
     - –ü—Ä–∏–º–µ—Ä –¥–ª—è –º—É–∂—á–∏–Ω:  
       - –ò—Å—Ö–æ–¥–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è: `[25, NaN, 30]`  
       - –ü–æ—Å–ª–µ –∑–∞–º–µ–Ω—ã: `[25, 27.5, 30]`  

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**  
```
  Gender   Age
0      M  25.0
1      F  31.5
2      M  30.0
3      F  28.0
4      M  27.5
5      F  35.0
```

---

### **–ö–ª—é—á–µ–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã**
1. **–ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–ø—É—Å–∫–æ–≤ –ø—Ä–∏ —Ä–∞—Å—á—ë—Ç–µ –º–µ–¥–∏–∞–Ω—ã**  
   - –ú–µ—Ç–æ–¥ `median()` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–∫–ª—é—á–∞–µ—Ç `NaN` –∏–∑ —Ä–∞—Å—á—ë—Ç–æ–≤.  

2. **`transform()` vs `apply()`**  
   - **`transform()`**: —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –∏—Å—Ö–æ–¥–Ω—ã–π –∏–Ω–¥–µ–∫—Å –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Ç–æ–π –∂–µ –¥–ª–∏–Ω—ã, —á—Ç–æ –∏ –≥—Ä—É–ø–ø–∞.  
   - **`apply()`**: –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å –∏–Ω–¥–µ–∫—Å–æ–º –≥—Ä—É–ø–ø (–Ω–∞–ø—Ä–∏–º–µ—Ä, `Gender`).  

3. **–ü–æ—Ä—è–¥–æ–∫ –æ–ø–µ—Ä–∞—Ü–∏–π**  
   - –°–Ω–∞—á–∞–ª–∞ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –º–µ–¥–∏–∞–Ω—É –¥–ª—è –≥—Ä—É–ø–ø, –∑–∞—Ç–µ–º –∑–∞–º–µ–Ω—è–µ–º –ø—Ä–æ–ø—É—Å–∫–∏.  
   - –ï—Å–ª–∏ –±—ã –º—ã —Å–Ω–∞—á–∞–ª–∞ –∑–∞–º–µ–Ω–∏–ª–∏ –ø—Ä–æ–ø—É—Å–∫–∏, –º–µ–¥–∏–∞–Ω–∞ –±—ã –∏–∑–º–µ–Ω–∏–ª–∞—Å—å, —á—Ç–æ –ø—Ä–∏–≤–µ–ª–æ –±—ã –∫ –æ—à–∏–±–∫–∞–º.  

---

### **–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è**
**–í–∞—Ä–∏–∞–Ω—Ç 1: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `map()`**  
```python
df['Age'] = df['Age'].fillna(
    df['Gender'].map(median_ages)
)
```

**–í–∞—Ä–∏–∞–Ω—Ç 2: –ü—Ä—è–º–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `groupby` + `apply`**  
```python
df['Age'] = df.groupby('Gender')['Age'].apply(
    lambda x: x.fillna(x.median())
)
```


---

## 3. **–°–æ–∑–¥–∞–Ω–∏–µ —Å–≤–æ–¥–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü**  
**–ó–∞–¥–∞—á–∞:**  
–°–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–æ –¥–≤—É–º –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º (—Å—Ç—Ä–∞–Ω–∞ –∏ –≥–æ–¥) –∏ —Ä–∞—Å—Å—á–∏—Ç–∞—Ç—å —Å—Ä–µ–¥–Ω–∏–π –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å.  

**–ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞:**  
"""

import pandas as pd

data = {
    'Country': ['USA', 'USA', 'Canada', 'Canada', 'USA', 'Canada'],
    'Year': [2020, 2021, 2020, 2021, 2022, 2022],
    'Score': [85, 90, 78, 82, 88, 89]
}

df = pd.DataFrame(data)
pivot_table = pd.pivot_table(df,
                           index='Country',
                           columns='Year',
                           values='Score',
                           aggfunc='mean')
print(pivot_table)

"""### –û–±—ä—è—Å–Ω–µ–Ω–∏–µ —Ä–µ—à–µ–Ω–∏—è –∑–∞–¥–∞—á–∏:


### **1. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `pivot_table`**
```python
pivot_table = pd.pivot_table(df,
                           index='Country',
                           columns='Year',
                           values='Score',
                           aggfunc='mean')
```
**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Ñ—É–Ω–∫—Ü–∏–∏:**  
1. **`index='Country'`**  
   - –£–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ –¥–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å—Å—è –ø–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏—è–º –≤ —Å—Ç–æ–ª–±—Ü–µ `Country`.  
   - –†–µ–∑—É–ª—å—Ç–∞—Ç: —Å—Ç—Ä–æ–∫–∏ —Ç–∞–±–ª–∏—Ü—ã –±—É–¥—É—Ç –Ω–∞–∑–≤–∞–Ω—ã —Å—Ç—Ä–∞–Ω–∞–º–∏ (`USA`, `Canada`).  

2. **`columns='Year'`**  
   - –£–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ –¥–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å—Å—è –ø–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏—è–º –≤ —Å—Ç–æ–ª–±—Ü–µ `Year`.  
   - –†–µ–∑—É–ª—å—Ç–∞—Ç: —Å—Ç–æ–ª–±—Ü—ã —Ç–∞–±–ª–∏—Ü—ã –±—É–¥—É—Ç –Ω–∞–∑–≤–∞–Ω—ã –≥–æ–¥–∞–º–∏ (`2020`, `2021`, `2022`).  

3. **`values='Score'`**  
   - –£–∫–∞–∑—ã–≤–∞–µ—Ç, –∫–∞–∫–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –±—É–¥—É—Ç –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞—Ç—å—Å—è.  

4. **`aggfunc='mean'`**  
   - –£–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ –¥–ª—è –∫–∞–∂–¥–æ–π –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ `Country` –∏ `Year` –±—É–¥–µ—Ç —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—Ç—å—Å—è **—Å—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ** —Å—Ç–æ–ª–±—Ü–∞ `Score`.  

---

### **–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è**
#### **–í–∞—Ä–∏–∞–Ω—Ç 1: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `groupby` + `mean`**
```python
grouped = df.groupby(['Country', 'Year'])['Score'].mean().unstack()
```
**–†–µ–∑—É–ª—å—Ç–∞—Ç:**  
```
Year       2020  2021  2022
Country            
Canada     78.0  82.0  89.0
USA        85.0  90.0  88.0
```

#### **–í–∞—Ä–∏–∞–Ω—Ç 2: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `pivot_table` —Å `aggfunc`**
```python
pd.pivot_table(df,
              index='Country',
              columns='Year',
              values='Score',
              aggfunc=lambda x: x.mean())
```

---

### **–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ `pivot_table`**
1. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–æ–ø—É—Å–∫–æ–≤**  
   –ï—Å–ª–∏ –¥–ª—è –∫–∞–∫–æ–π-—Ç–æ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ `Country-Year` –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö, –≤ —Ç–∞–±–ª–∏—Ü–µ –±—É–¥–µ—Ç `NaN`.  
   –ü—Ä–∏–º–µ—Ä: –µ—Å–ª–∏ –¥–æ–±–∞–≤–∏—Ç—å —Å—Ç—Ä–æ–∫—É `USA-2023` –±–µ–∑ –∑–Ω–∞—á–µ–Ω–∏–π, —Ä–µ–∑—É–ª—å—Ç–∞—Ç –±—É–¥–µ—Ç:  
   ```
   Year       2020  2021  2022  2023
   Country            
   Canada     78.0  82.0  89.0   NaN
   USA        85.0  90.0  88.0   NaN
   ```

2. **–ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º —Å—Ç–æ–ª–±—Ü–∞–º**  
   –î–ª—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏ –ø–æ —Ç—Ä—ë–º –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º (–Ω–∞–ø—Ä–∏–º–µ—Ä, `Country`, `Year`, `Region`):  
   ```python
   pd.pivot_table(df,
                index=['Country', 'Region'],
                columns='Year',
                values='Score',
                aggfunc='mean')
   ```

---

### **–°–æ–≤–µ—Ç—ã**
1. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö**  
   –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ —Å—Ç–æ–ª–±—Ü–µ `Score` –Ω–µ—Ç –ø—Ä–æ–ø—É—Å–∫–æ–≤ (`NaN`), –µ—Å–ª–∏ –æ–Ω–∏ –Ω–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å.  
2. **–í—ã–±–æ—Ä –∞–≥—Ä–µ–≥–∏—Ä—É—é—â–µ–π —Ñ—É–Ω–∫—Ü–∏–∏**  
   –í–º–µ—Å—Ç–æ `mean` –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `sum`, `max`, `min` –∏–ª–∏ –¥–∞–∂–µ –∫–∞—Å—Ç–æ–º–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏.  
3. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–æ–ø—É—Å–∫–æ–≤**  
   –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –¥–ª—è –∫–∞–∫–æ–π-—Ç–æ –≥—Ä—É–ø–ø—ã, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `fillna()` –¥–ª—è –∑–∞–º–µ–Ω—ã `NaN` –Ω–∞ –Ω—É–∂–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ.

## 4. **–†–∞—Å—á—ë—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π**  
**–ó–∞–¥–∞—á–∞:**  
–ù–∞–π—Ç–∏ –º–µ–¥–∏–∞–Ω—É, —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –∏ –∫–≤–∞–Ω—Ç–∏–ª–∏ –¥–ª—è —Å—Ç–æ–ª–±—Ü–∞ `Price`.  

**–ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞:**
"""

import pandas as pd

df = pd.DataFrame({
    'Price': [10, 15, 20, 25, 30, 35]
})

stats = df['Price'].agg(['median', 'std', 'quantile'])
print(stats)

"""### –û–±—ä—è—Å–Ω–µ–Ω–∏–µ —Ä–µ—à–µ–Ω–∏—è –∑–∞–¥–∞—á–∏:

### **1. –†–∞—Å—á—ë—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π**
```python
stats = df['Price'].agg(['median', 'std', 'quantile'])
```
**–≠—Ç–∞–ø—ã —Ä–∞–±–æ—Ç—ã:**  
1. **`df['Price']`**  
   - –í—ã–±–∏—Ä–∞–µ–º —Å—Ç–æ–ª–±–µ—Ü `Price` –∏–∑ –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–∞.  

2. **`.agg([...])`**  
   - –ü—Ä–∏–º–µ–Ω—è–µ—Ç —É–∫–∞–∑–∞–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∫ –≤—ã–±—Ä–∞–Ω–Ω–æ–º—É —Å—Ç–æ–ª–±—Ü—É.  
   - **–§—É–Ω–∫—Ü–∏–∏:**  
     - `median` ‚Üí –º–µ–¥–∏–∞–Ω–∞  
     - `std` ‚Üí —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ  
     - `quantile` ‚Üí –∫–≤–∞–Ω—Ç–∏–ª–∏
---

### **–ö–ª—é—á–µ–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã**
1. **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Ñ—É–Ω–∫—Ü–∏–π**  
   - –î–ª—è `quantile()` –º–æ–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –ø—Ä–æ—Ü–µ–Ω—Ç—ã:  
     ```python
     df['Price'].quantile([0.25, 0.5, 0.75])
     ```
2. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–æ–ø—É—Å–∫–æ–≤**  
   - –ï—Å–ª–∏ –≤ –¥–∞–Ω–Ω—ã—Ö –µ—Å—Ç—å `NaN`, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `dropna()` –∏–ª–∏ `fillna()`.  

---

### **–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è**
**–í–∞—Ä–∏–∞–Ω—Ç 1: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `describe()`**  
```python
df['Price'].describe()
```
**–†–µ–∑—É–ª—å—Ç–∞—Ç:**  
```
count    6.000000
mean    22.500000
std      6.880000
min     10.000000
25%     17.500000
50%     22.500000
75%     27.500000
max     35.000000
```

**–í–∞—Ä–∏–∞–Ω—Ç 2: –†–∞—Å—á—ë—Ç –∫–≤–∞–Ω—Ç–∏–ª–µ–π –æ—Ç–¥–µ–ª—å–Ω–æ**  
```python
q1 = df['Price'].quantile(0.25)
median = df['Price'].median()
q3 = df['Price'].quantile(0.75)
```

## **–ó–∞–∫–ª—é—á–µ–Ω–∏–µ: –ø–æ—á–µ–º—É Pandas –≤–∞–∂–µ–Ω –∏ –∫–∞–∫ –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å—Å—è –∫ —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏—é**  

Pandas ‚Äî **–æ—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç** –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –≤ Python. –ï–≥–æ –æ—Å–≤–æ–µ–Ω–∏–µ **–¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—É—é –∫–æ–º–ø–µ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å** –≤ —Ä–æ–ª—è—Ö Data Analyst, Data Scientist –∏ –∏–Ω–∂–µ–Ω–µ—Ä–æ–≤ –¥–∞–Ω–Ω—ã—Ö.  

**–ù–∞ —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–∏ –≤–æ–ø—Ä–æ—Å—ã –ø–æ Pandas –ø—Ä–æ–≤–µ—Ä—è—é—Ç:**  
1. **–°–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å —Ä–µ—à–∞—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ –∑–∞–¥–∞—á–∏**:  
   - –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö, –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü, —Ä–∞—Å—á—ë—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏.  
2. **–ü–æ–Ω–∏–º–∞–Ω–∏–µ –±–∞–∑–æ–≤—ã—Ö –∫–æ–Ω—Ü–µ–ø—Ü–∏–π**:  
   - `DataFrame`, `Series`, `groupby`, `merge()`.  
3. **–ù–∞–≤—ã–∫ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø—Ä–æ–ø—É—Å–∫–æ–≤ –∏ –æ—à–∏–±–æ–∫**:  
   - –ó–∞–º–µ–Ω–∞ `NaN`, –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö, –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤.  

**–°–æ–≤–µ—Ç**:  
–ù–∞ —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–∏ **–∑–∞–¥–∞–≤–∞–π—Ç–µ —É—Ç–æ—á–Ω—è—é—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã** (¬´–ö–∞–∫–∏–µ –ø—Ä–æ–ø—É—Å–∫–∏ –≤ –¥–∞–Ω–Ω—ã—Ö?¬ª), —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –æ—à–∏–±–æ–∫ –∏ –ø—Ä–æ–¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –æ—Å–æ–∑–Ω–∞–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥.  

---

**–ò—Ç–æ–≥**:  
- **–ü—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ –∑–∞–¥–∞—á–∏** –Ω–∞ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫—É, –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É.  
- **–ò–∑—É—á–∞–π—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é** –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Ñ—É–Ω–∫—Ü–∏–π.  
- **–†–∞–±–æ—Ç–∞–π—Ç–µ –Ω–∞–¥ –ø—Ä–æ–µ–∫—Ç–∞–º–∏**, –≥–¥–µ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è —ç—Ç–∏ –Ω–∞–≤—ã–∫–∏.  

**–£–¥–∞—á–∏!** üöÄ
"""